{"ast":null,"code":"import _regeneratorRuntime from\"/home/duythai/Developer/sadness/a-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/duythai/Developer/sadness/a-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/duythai/Developer/sadness/a-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/home/duythai/Developer/sadness/a-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncIterator from\"/home/duythai/Developer/sadness/a-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncIterator\";import React,{useState,useEffect}from'react';import{ToastContainer,toast}from\"react-toastify\";import axios from\"axios\";import LikeComment from\"./likeComment\";import ChatBubbleOutlineOutlinedIcon from'@material-ui/icons/ChatBubbleOutlineOutlined';import{IconButton}from'@material-ui/core';import RequireLogin from'./requireLogin';import socketApp from'../socket';function Comment(props){var _props$props=props.props,value=_props$props.value,id=_props$props.id;var socket=socketApp.getSocket();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),start=_useState4[0],setStart=_useState4[1];var _useState5=useState(10),_useState6=_slicedToArray(_useState5,2),end=_useState6[0],setEnd=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),comment=_useState8[0],setComment=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),login=_useState10[0],setLogin=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),load=_useState12[0],setLoad=_useState12[1];var _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),buttonFind=_useState14[0],setButtonfind=_useState14[1];var handleSubmit=function handleSubmit(e){if(text.length>0){e.preventDefault();setText(\"\");socket.emit(\"comment\",{idRecieve:value.idBlog,idSent:id,value:text},function(error){if(error===\"error\"){toast.error(\"Có lỗi đó xảy ra bạn hãy thử lại sau\");}else{toast.success(\"Yêu cầu của bạn đã được thực hiện\");}});}};var fetchData=function fetchData(){setLoad(true);setTimeout(function(){setStart(start+10);setEnd(end+10);},1500);};var handleLoginValidate=function handleLoginValidate(){if(!id){setLogin(true);}else{setLogin(null);}};var loadMoreButton=/*#__PURE__*/_jsx(\"div\",{className:\"button_load_more\",children:load===false?/*#__PURE__*/_jsx(\"button\",{onClick:fetchData,children:\"T\\u1EA3i th\\xEAm\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"loaderBalls\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"yellow\"}),/*#__PURE__*/_jsx(\"div\",{className:\"red\"}),/*#__PURE__*/_jsx(\"div\",{className:\"blue\"})]})});useEffect(function(){axios.get(\"http://localhost:2704/api/news/comment?start=\"+start+\"&end=\"+end+\"&id=\"+id+\"&blog=\"+value.idBlog).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){var a,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_loop,_iterator,_step,_value;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:a=res.data.data;if(!(a.length>=4)){_context.next=4;break;}setButtonfind(false);return _context.abrupt(\"return\",setLoad(false));case 4:_iteratorNormalCompletion=true;_didIteratorError=false;_context.prev=6;_loop=function _loop(){var value=_value;setComment(function(a){return[].concat(_toConsumableArray(a),[value]);});};_iterator=_asyncIterator(a);case 9:_context.next=11;return _iterator.next();case 11:_step=_context.sent;_iteratorNormalCompletion=_step.done;_context.next=15;return _step.value;case 15:_value=_context.sent;if(_iteratorNormalCompletion){_context.next=21;break;}_loop();case 18:_iteratorNormalCompletion=true;_context.next=9;break;case 21:_context.next=27;break;case 23:_context.prev=23;_context.t0=_context[\"catch\"](6);_didIteratorError=true;_iteratorError=_context.t0;case 27:_context.prev=27;_context.prev=28;if(!(!_iteratorNormalCompletion&&_iterator.return!=null)){_context.next=32;break;}_context.next=32;return _iterator.return();case 32:_context.prev=32;if(!_didIteratorError){_context.next=35;break;}throw _iteratorError;case 35:return _context.finish(32);case 36:return _context.finish(27);case 37:setLoad(false);case 38:case\"end\":return _context.stop();}}},_callee,null,[[6,23,27,37],[28,,32,36]]);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(err){return/*#__PURE__*/_jsx(\"div\",{children:\"C\\xF3 l\\u1ED7i \\u0111\\u1EA3 x\\u1EA3y ra b\\u1EA1n h\\xE3y th\\u1EED l\\u1EA1i sau\"});});},[end]);return/*#__PURE__*/_jsxs(\"div\",{className:\"comment_a_blog\",children:[login?/*#__PURE__*/_jsx(RequireLogin,{onClick:function onClick(value){return setLogin(value);}}):console.log(),/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsxs(\"form\",{className:\"input-container ex\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{onClick:handleLoginValidate,suppressContentEditableWarning:true,contentEditable:true,id:\"txtSearch\",onInput:function onInput(e){return setText(e.target.innerText);}}),/*#__PURE__*/_jsx(IconButton,{type:\"submit\",id:\"btnSearch\",className:\"comment\",children:/*#__PURE__*/_jsx(ChatBubbleOutlineOutlinedIcon,{})})]}),comment.length>0?comment.map(function(vari,i){return/*#__PURE__*/_jsx(\"div\",{className:\"content_comment_a_blog\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"value_content_comment_a_blog\",children:[/*#__PURE__*/_jsx(\"img\",{alt:\"avatar_user\",src:\"../demo.jpeg\"}),/*#__PURE__*/_jsxs(\"div\",{children:[vari.data.map(function(data,index){return/*#__PURE__*/_jsx(\"p\",{children:data},index);}),/*#__PURE__*/_jsx(LikeComment,{props:{data:vari,i:i,value:value.idBlog}})]})]})},i);}):console.log(),buttonFind===true&&comment.length>5?loadMoreButton:console.log()]});}export default Comment;","map":{"version":3,"sources":["/home/duythai/Developer/sadness/a-client/src/helpers/comment.js"],"names":["React","useState","useEffect","ToastContainer","toast","axios","LikeComment","ChatBubbleOutlineOutlinedIcon","IconButton","RequireLogin","socketApp","Comment","props","value","id","socket","getSocket","text","setText","start","setStart","end","setEnd","comment","setComment","login","setLogin","load","setLoad","buttonFind","setButtonfind","handleSubmit","e","length","preventDefault","emit","idRecieve","idBlog","idSent","error","success","fetchData","setTimeout","handleLoginValidate","loadMoreButton","get","then","res","a","data","catch","err","console","log","target","innerText","map","vari","i","index"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { ToastContainer, toast } from \"react-toastify\";\nimport axios from \"axios\"\nimport LikeComment from \"./likeComment\"\nimport ChatBubbleOutlineOutlinedIcon from '@material-ui/icons/ChatBubbleOutlineOutlined';\nimport { IconButton } from '@material-ui/core';\nimport RequireLogin from './requireLogin';\nimport socketApp from '../socket';\n\nfunction Comment(props) {\n    const { value, id } = props.props\n    let socket = socketApp.getSocket();\n    const [text, setText] = useState(\"\")\n    const [start, setStart] = useState(0)\n    const [end, setEnd] = useState(10)\n    const [comment, setComment] = useState([])\n    const [login, setLogin] = useState(null)\n    const [load, setLoad] = useState(false)\n    const [buttonFind, setButtonfind] = useState(true)\n\n    const handleSubmit = (e) => {\n        if (text.length > 0) {\n            e.preventDefault()\n            setText(\"\")\n            socket.emit(\"comment\", { idRecieve: value.idBlog, idSent: id, value: text }, (error) => {\n                if (error === \"error\") {\n                    toast.error(\"Có lỗi đó xảy ra bạn hãy thử lại sau\")\n                } else {\n                    toast.success(\"Yêu cầu của bạn đã được thực hiện\")\n                }\n            })\n        }\n    }\n    const fetchData = () => {\n        setLoad(true)\n        setTimeout(() => {\n            setStart(start + 10)\n            setEnd(end + 10)\n        }, 1500)\n    }\n    const handleLoginValidate = () => {\n        if (!id) {\n            setLogin(true)\n        } else {\n            setLogin(null)\n        }\n    }\n    let loadMoreButton = <div className=\"button_load_more\">\n        {load === false ? <button onClick={fetchData}>Tải thêm</button>\n            :\n            <div className=\"loaderBalls\">\n                <div className=\"yellow\"></div>\n                <div className=\"red\"></div>\n                <div className=\"blue\"></div>\n            </div>\n        }\n    </div>\n\n    useEffect(() => {\n        axios.get(\"http://localhost:2704/api/news/comment?start=\" + start + \"&end=\" + end + \"&id=\" + id + \"&blog=\" + value.idBlog)\n            .then(async res => {\n                let a = res.data.data\n                if (a.length >= 4) {\n                    setButtonfind(false)\n                    return setLoad(false)\n                }\n                for await (let value of a) {\n                    setComment(a => [...a, value])\n                }\n                setLoad(false)\n            })\n            .catch(err => {\n                return (\n                    <div>\n                        Có lỗi đả xảy ra bạn hãy thử lại sau\n                    </div>\n                )\n            })\n    }, [end])\n    return (\n        <div className=\"comment_a_blog\">\n            {login ? <RequireLogin onClick={(value) => setLogin(value)} /> : console.log()}\n            <ToastContainer />\n            <form className=\"input-container ex\" onSubmit={handleSubmit}>\n                <div\n                    onClick={handleLoginValidate}\n                    suppressContentEditableWarning={true}\n                    contentEditable\n                    id=\"txtSearch\"\n                    onInput={e => setText(e.target.innerText)}\n                >\n                </div>\n                <IconButton type=\"submit\" id=\"btnSearch\" className=\"comment\">\n                    <ChatBubbleOutlineOutlinedIcon />\n                </IconButton>\n            </form>\n            {\n                comment.length > 0 ? comment.map(function (vari, i) {\n                    return (\n                        <div key={i} className=\"content_comment_a_blog\">\n                            <div className=\"value_content_comment_a_blog\">\n                                <img alt=\"avatar_user\" src=\"../demo.jpeg\"></img>\n                                <div>\n                                    {\n                                        vari.data.map(function (data, index) {\n                                            return <p key={index}>{data}</p>\n                                        })\n                                    }\n                                    <LikeComment props={{ data: vari, i, value: value.idBlog }} />\n                                </div>\n                            </div>\n\n                        </div>\n                    )\n                }) : console.log()\n            }\n            {buttonFind === true && comment.length > 5 ? loadMoreButton : console.log()}\n        </div>\n    )\n}\n\nexport default Comment\n"]},"metadata":{},"sourceType":"module"}