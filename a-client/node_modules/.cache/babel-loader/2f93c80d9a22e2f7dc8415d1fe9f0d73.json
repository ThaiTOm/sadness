{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/dthai/sadness/a-client/src/helpers/main/PeerMany.js\";\n\nconst {\n  createEmptyAudioTrack,\n  createNullStream\n} = require(\"../message/audio\"); // turn on or turn off own volumn\n\n\nexport const setVolumnOwn = async ({\n  audio,\n  volumn\n}) => {\n  let arr = [];\n\n  for await (let data of audio) {\n    // copy old object\n    let value = Object.assign({}, data.stream.props, {\n      seleted: false,\n      writeable: true\n    });\n    let old = Object.assign({}, data.stream, {\n      writeable: true,\n      seleted: false\n    });\n    value.muted = !volumn; // delete specific key\n\n    delete value[\"seleted\"];\n    delete value[\"writeable\"];\n    old.props = value;\n    delete old[\"seleted\"];\n    delete old[\"writeable\"]; // create new object\n    // to handle new data\n\n    let obj = {\n      stream: old,\n      audio: data.audio,\n      mic: false\n    };\n    arr.push(obj);\n  }\n\n  return arr;\n}; // Turn on or turn off the own mic\n\nexport const setMicOwn = ({\n  mic,\n  oldPeer,\n  audio\n}) => {\n  if (mic === true) {\n    const audioTrack = createEmptyAudioTrack();\n    let data = oldPeer.connections;\n\n    for (let i = 0; i < audio.length; i++) {\n      let userMic = Object.keys(data)[i];\n      let sender = data[userMic][0].peerConnection.getSenders()[0] || [];\n      sender.replaceTrack(audioTrack);\n    }\n  } // else reconnect peer to peer \n  else {\n      navigator.mediaDevices.getUserMedia({\n        video: false,\n        audio: true\n      }).then(stream => {\n        let data = oldPeer.connections;\n\n        for (let i = 0; i < audio.length; i++) {\n          let userMic = Object.keys(data)[i];\n          let sender = data[userMic][0].peerConnection.getSenders()[0];\n          sender.replaceTrack(stream.getAudioTracks()[0]);\n        }\n      }).catch(err => {});\n    }\n};\nexport const setVolumnOther = ({\n  oldPeer,\n  i,\n  audio,\n  value\n}) => {\n  let idMuted = Object.keys(oldPeer.connections)[i];\n  let sender = oldPeer.connections[idMuted][0].peerConnection.getSenders()[0] || [];\n\n  const returnAudio = (stream, streamNull) => {\n    let a = /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: audio => audio ? audio.srcObject = stream : streamNull,\n      playsInline: true,\n      autoPlay: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }, this);\n\n    let obj = {\n      stream: a,\n      audio: false,\n      mic: true\n    };\n    let arr = [...audio];\n    arr[i] = obj;\n    return arr;\n  };\n\n  if (value.audio === true) {\n    let audioTrack = createEmptyAudioTrack();\n    sender.replaceTrack(audioTrack);\n    const streamNull = new MediaStream([audioTrack]);\n    returnAudio(streamNull, streamNull);\n  } else {\n    navigator.mediaDevices.getUserMedia({\n      video: false,\n      audio: true\n    }).then(stream => {\n      sender.replaceTrack(stream.getAudioTracks()[0]);\n      returnAudio(stream, createNullStream());\n    });\n  }\n};","map":{"version":3,"sources":["/home/dthai/sadness/a-client/src/helpers/main/PeerMany.js"],"names":["createEmptyAudioTrack","createNullStream","require","setVolumnOwn","audio","volumn","arr","data","value","Object","assign","stream","props","seleted","writeable","old","muted","obj","mic","push","setMicOwn","oldPeer","audioTrack","connections","i","length","userMic","keys","sender","peerConnection","getSenders","replaceTrack","navigator","mediaDevices","getUserMedia","video","then","getAudioTracks","catch","err","setVolumnOther","idMuted","returnAudio","streamNull","a","srcObject","MediaStream"],"mappings":"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","sourcesContent":["const { createEmptyAudioTrack, createNullStream } = require(\"../message/audio\")\n\n// turn on or turn off own volumn\n\nexport const setVolumnOwn = async ({ audio, volumn }) => {\n    let arr = []\n    for await (let data of audio) {\n        // copy old object\n        let value = Object.assign({}, data.stream.props, { seleted: false, writeable: true })\n        let old = Object.assign({}, data.stream, { writeable: true, seleted: false })\n        value.muted = !volumn\n        // delete specific key\n        delete value[\"seleted\"]\n        delete value[\"writeable\"]\n        old.props = value\n        delete old[\"seleted\"]\n        delete old[\"writeable\"]\n        // create new object\n        // to handle new data\n        let obj = {\n            stream: old,\n            audio: data.audio,\n            mic: false\n        }\n        arr.push(obj)\n    }\n    return arr\n}\n// Turn on or turn off the own mic\nexport const setMicOwn = ({ mic, oldPeer, audio }) => {\n    if (mic === true) {\n        const audioTrack = createEmptyAudioTrack();\n        let data = oldPeer.connections\n        for (let i = 0; i < audio.length; i++) {\n            let userMic = Object.keys(data)[i]\n            let sender = data[userMic][0].peerConnection.getSenders()[0] || []\n            sender.replaceTrack(audioTrack)\n        }\n    }\n    // else reconnect peer to peer \n    else {\n        navigator.mediaDevices.getUserMedia({ video: false, audio: true }).then(stream => {\n            let data = oldPeer.connections\n            for (let i = 0; i < audio.length; i++) {\n                let userMic = Object.keys(data)[i]\n                let sender = data[userMic][0].peerConnection.getSenders()[0]\n                sender.replaceTrack(stream.getAudioTracks()[0])\n            }\n        }).catch(err => {\n        })\n    }\n}\nexport const setVolumnOther = ({ oldPeer, i, audio, value }) => {\n    let idMuted = Object.keys(oldPeer.connections)[i]\n    let sender = oldPeer.connections[idMuted][0].peerConnection.getSenders()[0] || []\n    const returnAudio = (stream, streamNull) => {\n        let a = (\n            <audio ref={audio => audio ? audio.srcObject = stream : streamNull} playsInline autoPlay />\n        )\n        let obj = {\n            stream: a,\n            audio: false,\n            mic: true\n        }\n        let arr = [...audio]\n        arr[i] = obj\n        return arr\n    }\n    if (value.audio === true) {\n        let audioTrack = createEmptyAudioTrack()\n        sender.replaceTrack(audioTrack)\n        const streamNull = new MediaStream([audioTrack]);\n        returnAudio(streamNull, streamNull)\n    } else {\n        navigator.mediaDevices.getUserMedia({ video: false, audio: true }).then(stream => {\n            sender.replaceTrack(stream.getAudioTracks()[0])\n            returnAudio(stream, createNullStream())\n        })\n    }\n}"]},"metadata":{},"sourceType":"module"}