{"ast":null,"code":"import cookie from\"js-cookie\";import{replaceTelex}from\"../algorithm/algorithm\";import CryptoJS from'crypto-js';//Set cookie\nexport var setCookie=function setCookie(key,value){if(window!==\"undefined\"){cookie.set(key,value,{expires:7});}};export var removeCookie=function removeCookie(key){if(window!==\"undefined\"){cookie.remove(key,{expires:1});}};export var getCookie=function getCookie(key){if(window!==\"undefined\"){return cookie.get(key);}};export var setLocalStorage=function setLocalStorage(key,value){if(window!==\"undefined\"){localStorage.setItem(key,JSON.stringify(value));}};export var removeLocalStorage=function removeLocalStorage(key){if(window!==\"undefined\"){localStorage.removeItem(key);}};// Auth user after login\nexport var authenicate=function authenicate(res,next){var userName;if(res.data.user.name){userName=replaceTelex(res.data.user.name);}else{userName=replaceTelex(res.data.user);}setCookie(\"token\",res.data.token);setLocalStorage(\"user\",userName);};// Sign out\nexport var signOut=function signOut(next){removeCookie(\"token\");removeLocalStorage(\"user\");};export var isAuth=function isAuth(){if(window!==\"undefined\"){var cookieChecked=getCookie(\"token\");if(cookieChecked){if(localStorage.getItem(\"user\")){return JSON.parse(localStorage.getItem(\"user\"));}else{return false;}}}};export var updateUser=function updateUser(res,next){if(window!==\"undefined\"){var auth=JSON.parse(localStorage.getItem(\"user\"));auth=res.data;localStorage.setItem(\"user\",JSON.stringify(auth));}next();};//  \nexport var encryptTo=function encryptTo(text){var passphrase='123nguyenduythaise1';return CryptoJS.AES.encrypt(text,passphrase).toString();};export var decryptWithAES=function decryptWithAES(ciphertext){var passphrase='123nguyenduythaise1';var bytes=CryptoJS.AES.decrypt(ciphertext,passphrase);var originalText;//if original text is defined that assign it\ntry{originalText=bytes.toString(CryptoJS.enc.Utf8);}catch(error){originalText=\"\";}return originalText;};","map":{"version":3,"sources":["/home/duythai/Developer/sadness/a-client/src/helpers/auth.js"],"names":["cookie","replaceTelex","CryptoJS","setCookie","key","value","window","set","expires","removeCookie","remove","getCookie","get","setLocalStorage","localStorage","setItem","JSON","stringify","removeLocalStorage","removeItem","authenicate","res","next","userName","data","user","name","token","signOut","isAuth","cookieChecked","getItem","parse","updateUser","auth","encryptTo","text","passphrase","AES","encrypt","toString","decryptWithAES","ciphertext","bytes","decrypt","originalText","enc","Utf8","error"],"mappings":"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","sourcesContent":["import cookie from \"js-cookie\";\nimport { replaceTelex } from \"../algorithm/algorithm\";\nimport CryptoJS from 'crypto-js';\n\n//Set cookie\nexport const setCookie = (key, value) => {\n    if (window !== \"undefined\") {\n        cookie.set(key, value, {\n            expires: 7\n        })\n    }\n}\nexport const removeCookie = key => {\n    if (window !== \"undefined\") {\n        cookie.remove(key, {\n            expires: 1\n        })\n    }\n}\nexport const getCookie = key => {\n    if (window !== \"undefined\") {\n        return cookie.get(key)\n    }\n}\nexport const setLocalStorage = (key, value) => {\n    if (window !== \"undefined\") {\n        localStorage.setItem(key, JSON.stringify(value))\n    }\n}\nexport const removeLocalStorage = key => {\n    if (window !== \"undefined\") {\n        localStorage.removeItem(key)\n    }\n}\n\n// Auth user after login\nexport const authenicate = (res, next) => {\n    let userName;\n    if (res.data.user.name) {\n        userName = replaceTelex(res.data.user.name)\n    } else {\n        userName = replaceTelex(res.data.user)\n    }\n    setCookie(\"token\", res.data.token);\n    setLocalStorage(\"user\", userName);\n}\n\n// Sign out\nexport const signOut = next => {\n    removeCookie(\"token\");\n    removeLocalStorage(\"user\");\n}\n\nexport const isAuth = () => {\n    if (window !== \"undefined\") {\n        const cookieChecked = getCookie(\"token\")\n        if (cookieChecked) {\n            if (localStorage.getItem(\"user\")) {\n                return JSON.parse(localStorage.getItem(\"user\"))\n            } else {\n                return false\n            }\n        }\n    }\n}\nexport const updateUser = (res, next) => {\n    if (window !== \"undefined\") {\n        let auth = JSON.parse(localStorage.getItem(\"user\"))\n        auth = res.data\n        localStorage.setItem(\"user\", JSON.stringify(auth))\n    }\n    next()\n}\n//  \nexport const encryptTo = text => {\n    const passphrase = '123nguyenduythaise1';\n    return CryptoJS.AES.encrypt(text, passphrase).toString();\n}\nexport const decryptWithAES = ciphertext => {\n    const passphrase = '123nguyenduythaise1';\n    const bytes = CryptoJS.AES.decrypt(ciphertext, passphrase);\n    let originalText\n    //if original text is defined that assign it\n    try {\n        originalText = bytes.toString(CryptoJS.enc.Utf8);\n    } catch (error) {\n        originalText = \"\"\n    }\n    return originalText;\n};"]},"metadata":{},"sourceType":"module"}